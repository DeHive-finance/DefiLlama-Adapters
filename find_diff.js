const fromBack = [
  {
    "id": 3,
    "networkId": 137,
    "symbol": "DGAME",
    "decimals": 18,
    "tvl": 14785.11,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:00.809638 +00:00"
  },
  {
    "id": 4,
    "networkId": 56,
    "symbol": "DBSC",
    "decimals": 18,
    "tvl": 38985.34,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:01.760075 +00:00"
  },
  {
    "id": 5,
    "networkId": 100,
    "symbol": "DXIN",
    "decimals": 18,
    "tvl": 38820.62,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:02.604339 +00:00"
  },
  {
    "id": 6,
    "networkId": 100,
    "symbol": "DXDC",
    "decimals": 18,
    "tvl": 90915.39,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:03.780589 +00:00"
  },
  {
    "id": 1,
    "networkId": 1,
    "symbol": "DECR",
    "decimals": 18,
    "tvl": 3925.02,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:05.870683 +00:00"
  },
  {
    "id": 2,
    "networkId": 137,
    "symbol": "DPOL",
    "decimals": 18,
    "tvl": 47196.14,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:06.592526 +00:00"
  },
  {
    "id": 15,
    "networkId": 137,
    "symbol": "SNX-WETH-IMPULSE",
    "tvl": 1274.16,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:26.517228 +00:00"
  },
  {
    "id": 30,
    "networkId": 56,
    "symbol": "TWT-WBNB-IMPULSE",
    "tvl": 0.00,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:29.657759 +00:00"
  },
  {
    "id": 34,
    "networkId": 100,
    "symbol": "DHV",
    "tvl": 40677.82,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:30.121851 +00:00"
  },
  {
    "id": 1,
    "networkId": 1,
    "symbol": "DHV",
    "tvl": 131977.57,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:30.931644 +00:00"
  },
  {
    "id": 21,
    "networkId": 56,
    "symbol": "BUSDT-USDC-IMPULSE",
    "tvl": 109.48,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:33.555530 +00:00"
  },
  {
    "id": 27,
    "networkId": 56,
    "symbol": "DODO-WBNB-IMPULSE",
    "tvl": 44.46,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:35.336294 +00:00"
  },
  {
    "id": 13,
    "networkId": 137,
    "symbol": "WMATIC-WETH-IMPULSE",
    "tvl": 2050.06,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:36.888694 +00:00"
  },
  {
    "id": 29,
    "networkId": 56,
    "symbol": "BANANA-BUSD-IMPULSE",
    "tvl": 0.00,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:39.263602 +00:00"
  },
  {
    "id": 9,
    "networkId": 137,
    "symbol": "USDC-QUICK-IMPULSE",
    "tvl": 847.06,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:40.535785 +00:00"
  },
  {
    "id": 19,
    "networkId": 56,
    "symbol": "DHV",
    "tvl": 105156.41,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:41.508222 +00:00"
  },
  {
    "id": 25,
    "networkId": 56,
    "symbol": "LINK-WBNB-IMPULSE",
    "tvl": 0.00,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:43.844754 +00:00"
  },
  {
    "id": 35,
    "networkId": 100,
    "symbol": "HONEY-DHV-WXDAI",
    "tvl": 18486.84,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:47.041260 +00:00"
  },
  {
    "id": 37,
    "networkId": 100,
    "symbol": "DXDC",
    "tvl": 90087.45,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:47.952054 +00:00"
  },
  {
    "id": 6,
    "networkId": 137,
    "symbol": "QCK-DHV-QUICK",
    "tvl": 92.91,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:49.899789 +00:00"
  },
  {
    "id": 12,
    "networkId": 137,
    "symbol": "AVAX-WETH-IMPULSE",
    "tvl": 2121.28,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:57.561749 +00:00"
  },
  {
    "id": 17,
    "networkId": 137,
    "symbol": "QCK-DHV-QUICK-NEW",
    "tvl": 147.70,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:02.050155 +00:00"
  },
  {
    "id": 14,
    "networkId": 137,
    "symbol": "CRV-WETH-IMPULSE",
    "tvl": 2222.69,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:03.907809 +00:00"
  },
  {
    "id": 28,
    "networkId": 56,
    "symbol": "BANANA-WBNB-IMPULSE",
    "tvl": 111.59,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:06.617452 +00:00"
  },
  {
    "id": 33,
    "networkId": 56,
    "symbol": "PANCAKE-DHV-BUSD",
    "tvl": 89658.39,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:10.277556 +00:00"
  },
  {
    "id": 10,
    "networkId": 137,
    "symbol": "USDC-MATIC-IMPULSE",
    "tvl": 1208.08,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:11.616595 +00:00"
  },
  {
    "id": 32,
    "networkId": 56,
    "symbol": "DBSC",
    "tvl": 37834.79,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:01.809739 +00:00"
  },
  {
    "id": 4,
    "networkId": 137,
    "symbol": "DPOL",
    "tvl": 45177.68,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:02.472672 +00:00"
  },
  {
    "id": 31,
    "networkId": 56,
    "symbol": "AVAX-WBNB-IMPULSE",
    "tvl": 0.00,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:06.452086 +00:00"
  },
  {
    "id": 24,
    "networkId": 56,
    "symbol": "ALPACA-BUSD-IMPULSE",
    "tvl": 1.97,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:09.629499 +00:00"
  },
  {
    "id": 16,
    "networkId": 137,
    "symbol": "WMATIC-GHST-IMPULSE",
    "tvl": 2656.91,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:11.077928 +00:00"
  },
  {
    "id": 22,
    "networkId": 56,
    "symbol": "BUSDT-WBNB-IMPULSE",
    "tvl": 5.38,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:13.165984 +00:00"
  },
  {
    "id": 8,
    "networkId": 137,
    "symbol": "WETH-DAI-IMPULSE",
    "tvl": 1797.84,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:14.777884 +00:00"
  },
  {
    "id": 5,
    "networkId": 137,
    "symbol": "DGAME",
    "tvl": 11960.57,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:16.041725 +00:00"
  },
  {
    "id": 36,
    "networkId": 100,
    "symbol": "DXIN",
    "tvl": 38817.45,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:16.927514 +00:00"
  },
  {
    "id": 20,
    "networkId": 56,
    "symbol": "CAKE-BUSD-IMPULSE",
    "tvl": 8.85,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:14.031846 +00:00"
  },
  {
    "id": 11,
    "networkId": 137,
    "symbol": "MAI-USDT-IMPULSE",
    "tvl": 19876.75,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:15.633053 +00:00"
  },
  {
    "id": 3,
    "networkId": 137,
    "symbol": "DHV",
    "tvl": 125261.56,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:16.028005 +00:00"
  },
  {
    "id": 26,
    "networkId": 56,
    "symbol": "CAKE-BUSDT-IMPULSE",
    "tvl": 0.00,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:18.447706 +00:00"
  },
  {
    "id": 7,
    "networkId": 137,
    "symbol": "DHV-QUICK-IMPULSE",
    "tvl": 135.48,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:19.817781 +00:00"
  },
  {
    "id": 18,
    "networkId": 137,
    "symbol": "CRV-IMPULSE",
    "tvl": 1757.34,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:11:20.473472 +00:00"
  },
  {
    "id": 2,
    "networkId": 1,
    "symbol": "UNI-DHV-WETH",
    "tvl": 202220.48,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:21.326536 +00:00"
  },
  {
    "id": 23,
    "networkId": 56,
    "symbol": "XVS-WBNB-IMPULSE",
    "tvl": 7.14,
    "apr": null,
    "apy": null,
    "createdAt": "2022-01-13 07:20:39.818857 +00:00",
    "updatedAt": "2022-01-20 08:10:23.718150 +00:00"
  }
];

const fromDefiLama =

  [
    {
      "networkId": 1,
      "symbol": "DHV",
      "tvl": 134901.8477323993,
      "type": "solo"
    },
    {
      "networkId": 1,
      "symbol": "UNI-DHV-WETH",
      "tvl": 339500.28256121126,
      "type": "lp"
    },
    {
      "networkId": 137,
      "symbol": "DHV",
      "tvl": 128037.03032020103,
      "type": "solo"
    },
    {
      "networkId": 137,
      "symbol": "DPOL",
      "tvl": 176620.1970948635,
      "type": "cluster"
    },
    {
      "networkId": 137,
      "symbol": "DGAME",
      "tvl": 193256.08120438457,
      "type": "cluster"
    },
    {
      "networkId": 137,
      "symbol": "CRV-IMPULSE",
      "tvl": 195018.66564431696,
      "type": "impulse-multiple"
    },
    {
      "networkId": 137,
      "symbol": "DHV-QUICK-IMPULSE",
      "tvl": 195297.0260046063,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "WETH-DAI-IMPULSE",
      "tvl": 198918.21293990785,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "USDC-QUICK-IMPULSE",
      "tvl": 202393.30584432682,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "MAI-USDT-IMPULSE",
      "tvl": 282301.63596622384,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "AVAX-WETH-IMPULSE",
      "tvl": 284594.6921301504,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "WMATIC-WETH-IMPULSE",
      "tvl": 288690.08105749346,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "CRV-WETH-IMPULSE",
      "tvl": 292012.957430118,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "SNX-WETH-IMPULSE",
      "tvl": 293962.3143478906,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "WMATIC-GHST-IMPULSE",
      "tvl": 298014.4473746624,
      "type": "impulse"
    },
    {
      "networkId": 137,
      "symbol": "QCK-DHV-QUICK",
      "tvl": 297996.59631465795,
      "type": "external"
    },
    {
      "networkId": 137,
      "symbol": "QCK-DHV-QUICK-NEW",
      "tvl": 297989.415556045,
      "type": "external"
    },
    {
      "networkId": 56,
      "symbol": "DHV",
      "tvl": 107486.40494094291,
      "type": "solo"
    },
    {
      "networkId": 56,
      "symbol": "DBSC",
      "tvl": 146373.5229339986,
      "type": "cluster"
    },
    {
      "networkId": 56,
      "symbol": "PANCAKE-DHV-BUSD",
      "tvl": 237141.62805858394,
      "type": "lp"
    },
    {
      "networkId": 56,
      "symbol": "CAKE-BUSD-IMPULSE",
      "tvl": 237150.47603325447,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "BUSDT-USDC-IMPULSE",
      "tvl": 237259.9585602175,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "BUSDT-WBNB-IMPULSE",
      "tvl": 237265.31361767562,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "XVS-WBNB-IMPULSE",
      "tvl": 237272.39671067562,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "ALPACA-BUSD-IMPULSE",
      "tvl": 237274.36197801193,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "LINK-WBNB-IMPULSE",
      "tvl": 237274.3619777188,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "CAKE-BUSDT-IMPULSE",
      "tvl": 237274.3619769989,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "DODO-WBNB-IMPULSE",
      "tvl": 237318.39428797024,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "BANANA-WBNB-IMPULSE",
      "tvl": 237429.27736614086,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "BANANA-BUSD-IMPULSE",
      "tvl": 237426.83861341744,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "TWT-WBNB-IMPULSE",
      "tvl": 237426.83879118925,
      "type": "impulse"
    },
    {
      "networkId": 56,
      "symbol": "AVAX-WBNB-IMPULSE",
      "tvl": 237426.83879571638,
      "type": "impulse"
    },
    {
      "networkId": 100,
      "symbol": "DHV",
      "tvl": 0,
      "type": "solo"
    },
    {
      "networkId": 100,
      "symbol": "DXIN",
      "tvl": 28515.246424086472,
      "type": "cluster"
    },
    {
      "networkId": 100,
      "symbol": "DXDC",
      "tvl": 110636.46353801634,
      "type": "cluster"
    },
    {
      "networkId": 100,
      "symbol": "HONEY-DHV-WXDAI",
      "tvl": 117168.16384611334,
      "type": "lp"
    }
  ];


const findRecord = (networkId, symbol, where) => {
  for (let i = 0; i < where.length; i++) {
    if (where[i].networkId === networkId && where[i].symbol === symbol) {
      return where[i];
    }
  }
  return null;
};


(() => {
  const diffAccuracy = 1.1;
  let tvlNotFound = 0;
  for (let i = 0; i < fromBack.length; i++) {
    const recordWhere = fromBack[i];
    const recordWhat = findRecord(recordWhere.networkId, recordWhere.symbol, fromDefiLama);
    if (recordWhat === null) {
      console.log("--------record not found--------------");
      console.log(JSON.stringify(recordWhere, null, 4));
      tvlNotFound += recordWhere.tvl;
      continue;
    }
    let tvl1 = recordWhat.tvl;
    let tvl2 = recordWhere.tvl;
    if (recordWhat.tvl > recordWhere.tvl) {
      tvl1 = recordWhere.tvl;
      tvl2 = recordWhat.tvl;
    }
    if (tvl2 / tvl1 >= diffAccuracy || (tvl1 === 0 && tvl2 !== 0) || (tvl2 === 0 && tvl1 !== 0)) {
      console.log("----------------------");
      console.log(JSON.stringify(recordWhere, null, 4));
      console.log(JSON.stringify(recordWhat, null, 4));
    }
  }
  console.log('tvlNotFound', tvlNotFound);
})();





// DGAME    15202.68
// DBSC     38152.89
// DXIN     38713.49
// DXDC     78008.53




// --------record not found-------------- skip in defilama
//   {
//     "id": 10,
//     "networkId": 137,
//     "symbol": "USDC-MATIC-IMPULSE",
//     "tvl": 1295.68,
//     "apr": null,
//     "apy": null,
//     "createdAt": "2022-01-13 07:20:39.818857 +00:00",
//     "updatedAt": "2022-01-17 11:38:58.295000 +00:00"
//   }


//
// --------record not found--------------  DECR missing in defilama!
//   {
//     "id": 1,
//     "networkId": 1,
//     "symbol": "DECR",
//     "decimals": 18,
//     "tvl": 4334,
//     "createdAt": "2022-01-13 07:20:39.818857 +00:00",
//     "updatedAt": "2022-01-17 11:42:02.511622 +00:00"
//   }




// ---------------------- check it
//   {
//     "id": 2,
//     "networkId": 137,
//     "symbol": "DPOL",
//     "decimals": 18,
//     "tvl": 53734.65,
//     "createdAt": "2022-01-13 07:20:39.818857 +00:00",
//     "updatedAt": "2022-01-17 11:42:03.329266 +00:00"
//   }
// {
//   "networkId": 137,
//   "symbol": "DPOL",
//   "tvl": 184977.16282787645
// }




(() => {
  let tvlNotFound = 0;
  let totalBalance = 0;
  for (let i = 0; i < fromBack.length; i++) {
    const recordWhere = fromBack[i];
    const recordWhat = findRecord(recordWhere.networkId, recordWhere.symbol, fromDefiLama);
    if (recordWhat === null) {
      console.log('\u001b[34m')
      console.log(recordWhere.networkId, recordWhere.symbol, recordWhere.tvl)
      tvlNotFound += recordWhere.tvl;
      continue;
    }
    let tvl1 = recordWhat.tvl;
    let tvl2 = recordWhere.tvl;
    if (recordWhat.tvl > recordWhere.tvl) {
      tvl1 = recordWhere.tvl;
      tvl2 = recordWhat.tvl;
    }
    let balance = recordWhat.tvl - recordWhere.tvl;
    totalBalance += balance;
    if (balance > 0)
      console.log('\u001b[32m')
    else
      console.log('\u001b[31m')

    console.log(recordWhere.networkId, recordWhere.symbol, recordWhat.type, balance)
  }

  for (let i = 0; i < fromDefiLama.length; i++) {
    const recordWhere = fromDefiLama[i];
    const recordWhat = findRecord(recordWhere.networkId, recordWhere.symbol, fromBack);
    if (recordWhat === null) {
      console.log('\u001b[36m')
      console.log(recordWhere.networkId, recordWhere.symbol, recordWhere.tvl)
      tvlNotFound += recordWhere.tvl;
      continue;
    }
  }
  console.log('\u001b[37m')
  console.log('totalBalance', totalBalance)
})();